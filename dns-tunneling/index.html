<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>DNS tunneling - Raptor Blog</title><meta name=Description content="Post about how we can route all our traffic through the DNS protocol to bypass certain protections"><meta property="og:title" content="DNS tunneling"><meta property="og:description" content="Post about how we can route all our traffic through the DNS protocol to bypass certain protections"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.anthares101.com/dns-tunneling/"><meta property="og:image" content="https://blog.anthares101.com/dns-tunneling/images/banner.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-13T00:00:00+00:00"><meta property="og:site_name" content="Raptor Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.anthares101.com/dns-tunneling/images/banner.jpg"><meta name=twitter:title content="DNS tunneling"><meta name=twitter:description content="Post about how we can route all our traffic through the DNS protocol to bypass certain protections"><meta name=application-name content="Raptor Blog"><meta name=apple-mobile-web-app-title content="Raptor Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.anthares101.com/dns-tunneling/><link rel=prev href=https://blog.anthares101.com/attacking-wi-fi-networks-with-aircrack-ng/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"DNS tunneling","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.anthares101.com\/dns-tunneling\/"},"image":["https:\/\/blog.anthares101.com\/banner.png"],"genre":"posts","keywords":"bypass, red team, network, exfiltration","wordcount":1311,"url":"https:\/\/blog.anthares101.com\/dns-tunneling\/","datePublished":"2022-11-13T00:00:00+00:00","dateModified":"2022-11-13T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Anthares101"},"description":"Post about how we can route all our traffic through the DNS protocol to bypass certain protections"}</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "0eec0c6a58a84bcea4130feee244a950"}'></script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Raptor Blog"><span class=header-title-pre><i class='fa-solid fa-flag'></i></span>Raptor Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://github.com/anthares101/raptor-blog title="Check the code!" rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Raptor Blog"><span class=header-title-pre><i class='fa-solid fa-flag'></i></span>Raptor Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=https://github.com/anthares101/raptor-blog title="Check the code!" rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">DNS tunneling</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/posts/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Anthares101</a></span>&nbsp;<span class=post-category>included in <a href=/categories/offensive-cybersecurity/><i class="far fa-folder fa-fw" aria-hidden=true></i>Offensive Cybersecurity</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-11-13>2022-11-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1311 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/dns-tunneling/images/banner.jpg data-srcset="/dns-tunneling/images/banner.jpg, /dns-tunneling/images/banner.jpg 1.5x, /dns-tunneling/images/banner.jpg 2x" data-sizes=auto alt=/dns-tunneling/images/banner.jpg title="Post about how we can route all our traffic through the DNS protocol to bypass certain protections" width=1366 height=768></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#requisites>Requisites</a></li><li><a href=#server-setup>Server setup</a><ul><li><a href=#troubleshooting>Troubleshooting</a></li></ul></li><li><a href=#client-setup>Client setup</a><ul><li><a href=#android>Android</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=dns-tunneling>DNS tunneling</h1><p>The idea of this technique is to use the DNS protocol to route all the traffic, just like a VPN! Of course this method will make your connection slower but will allow you to bypass certain systems like network filters or captive portals. Obviously, you could use this to exfiltrate data too.</p><p>The reason why this works is that normally when captive portals or firewalls rules are setup, the administrators block all TCP and UDP connections when certain rule is met but they forget about checking DNS queries. This means that, if all our traffic is routed through DNS, we will be able to bypass all this protections.</p><h2 id=requisites>Requisites</h2><ul><li>A VPS or machine that can be reached from the Internet for DNS requests without problems.</li><li>This little tool installed both in the client and the server that will handle the tunnel: <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a>.</li><li>Obviously a Domain.</li></ul><h2 id=server-setup>Server setup</h2><p>First of all we need to setup our VPS to be the authoritative DNS for one of our domains or subdomains (I prefer the second option to be honest). The procedure to do this looks like it is different from vendor to vendor so I will focus on Cloudflare.</p><p>Setup in one of our domains a NS record for a subdomain or our whole domain. In my case I will setup <code>dns.test.com</code> NS record to point to my VPS <code>vps.francecentral.cloudapp.azure.com</code>. This will tell Cloudflare that now, the authoritative DNS server is our VPS so the DNS queries should be sent to it. Make sure you point your NS record to an A record, at least in Cloudflare this is necessary and the record creation will fail if you try to use an IP address or a CNAME.</p><p>With that out of the way, go to your server and install <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a>. Now execute this (Make sure port 53 TCP/UDP is available):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>raptor@kestrel:~$ sudo iodined -f 10.2.0.1 dns.test.com
</span></span><span class=line><span class=cl>Enter tunnel password: 
</span></span><span class=line><span class=cl>Opened dns0
</span></span><span class=line><span class=cl>Setting IP of dns0 to 10.2.0.1
</span></span><span class=line><span class=cl>Setting MTU of dns0 to <span class=m>1130</span>
</span></span><span class=line><span class=cl>Opened IPv4 UDP socket
</span></span><span class=line><span class=cl>Opened IPv6 UDP socket
</span></span><span class=line><span class=cl>Listening to dns <span class=k>for</span> domain dns.test.com
</span></span></code></pre></td></tr></table></div></div><p>This will start the tool in server mode, the 10.2.0.1 IP is just the /24 CIDR block that the tunnel will use, for example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> SERVER ------------------------------------ CLIENT
</span></span><span class=line><span class=cl>10.2.0.1                                    10.2.0.2
</span></span></code></pre></td></tr></table></div></div><p>Make sure that the IP block used by the tunnel is not already in use by any of your client/server adapters. The password it is used to authenticate the clients and avoid unknown users.</p><h3 id=troubleshooting>Troubleshooting</h3><p>Port 53 TCP/UDP has to be reachable and obviouly useable by <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a>. If you have properly setup the network rules for your VPS to allow traffic to this port but you are still having problems, probably you have the service <code>systemd-resolved</code> running in the port 53. Change the file <code>/etc/resolv.conf</code> to point to a public DNS server and stop the service.</p><h2 id=client-setup>Client setup</h2><p>Once the Server is prepared, let’s connect to it. In our machine we will need <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a> too, luckily Kali already has it. Just execute this (The password is the one you configured in the server earlier):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo iodine -f -r vps.francecentral.cloudapp.azure.com dns.test.com                <span class=m>1</span> ⨯
</span></span><span class=line><span class=cl>Enter password: 
</span></span><span class=line><span class=cl>Opened dns0
</span></span><span class=line><span class=cl>Opened IPv4 UDP socket
</span></span><span class=line><span class=cl>Sending DNS queries <span class=k>for</span> dns.test.com to REDACTED
</span></span><span class=line><span class=cl>Autodetecting DNS query <span class=nb>type</span> <span class=o>(</span>use -T to override<span class=o>)</span>.
</span></span><span class=line><span class=cl>Using DNS <span class=nb>type</span> NULL queries
</span></span><span class=line><span class=cl>Version ok, both using protocol v 0x00000502. You are user <span class=c1>#0</span>
</span></span><span class=line><span class=cl>Setting IP of dns0 to 10.2.0.2
</span></span><span class=line><span class=cl>Setting MTU of dns0 to <span class=m>1130</span>
</span></span><span class=line><span class=cl>Server tunnel IP is 10.2.0.1
</span></span><span class=line><span class=cl>Skipping raw mode
</span></span><span class=line><span class=cl>Using EDNS0 extension
</span></span><span class=line><span class=cl>Switching upstream to codec Base128
</span></span><span class=line><span class=cl>Server switched upstream to codec Base128
</span></span><span class=line><span class=cl>No alternative downstream codec available, using default <span class=o>(</span>Raw<span class=o>)</span>
</span></span><span class=line><span class=cl>Switching to lazy mode <span class=k>for</span> low-latency
</span></span><span class=line><span class=cl>Server switched to lazy mode
</span></span><span class=line><span class=cl>Autoprobing max downstream fragment size... <span class=o>(</span>skip with -m fragsize<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>768</span> ok.. <span class=m>1152</span> ok.. ...1344 not ok.. ...1248 not ok.. ...1200 not ok.. <span class=m>1176</span> ok.. <span class=m>1188</span> ok.. will use 1188-2<span class=o>=</span><span class=m>1186</span>
</span></span><span class=line><span class=cl>Setting downstream fragment size to max 1186...
</span></span><span class=line><span class=cl>Connection setup complete, transmitting data.
</span></span></code></pre></td></tr></table></div></div><p>The output should be like that if everything went ok. You can also verify that the tunnel is open by going to a terminal and checking <code>ifconfig</code>, if you have the adapter <code>dns0</code> all is good:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ifconfig dns0
</span></span><span class=line><span class=cl>dns0: <span class=nv>flags</span><span class=o>=</span>4305&lt;UP,POINTOPOINT,RUNNING,NOARP,MULTICAST&gt;  mtu <span class=m>1130</span>
</span></span><span class=line><span class=cl>        inet 10.2.0.2  netmask 255.255.255.224  destination 10.2.0.2
</span></span><span class=line><span class=cl>        unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen <span class=m>500</span>  <span class=o>(</span>UNSPEC<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX packets <span class=m>0</span>  bytes <span class=m>0</span> <span class=o>(</span>0.0 B<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX errors <span class=m>0</span>  dropped <span class=m>0</span>  overruns <span class=m>0</span>  frame <span class=m>0</span>
</span></span><span class=line><span class=cl>        TX packets <span class=m>1</span>  bytes <span class=m>48</span> <span class=o>(</span>48.0 B<span class=o>)</span>
</span></span><span class=line><span class=cl>        TX errors <span class=m>0</span>  dropped <span class=m>0</span> overruns <span class=m>0</span>  carrier <span class=m>0</span>  collisions <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we can setup a SOCKS5 proxy and start routing our traffic, I recommend to use SSH for this to make sure the traffic is encrypted, otherwise the traffic can be intercepted and read if using insecure protocols (Remember that DNS is not encypted):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh -D <span class=m>8080</span> -q -C -N raptor@10.2.0.1 -i Projects/dns-tunnel/raptor.pem
</span></span></code></pre></td></tr></table></div></div><p>Some notes about this command:</p><ul><li>The IP address used: 10.2.0.1 is our VPS at the end of our DNS tunnel</li><li>The -D option is just telling SSH where the SOCKS5 proxy will listen for requests in our machine</li><li>The -q is just for quiet operation</li><li>The -N will tell SSH that we don’t want to execute commands so no prompt</li><li>And the most important option, -C. This will compress the traffic to reduce the bandwidth, what is something you are gonna be thankful about since the DNS tunnel is not what you will call something fast.</li></ul><p>Now just tunnel your traffic through the proxy! You can use something like <code>proxychains</code> or the OS proxy configuration to start tunneling stuff through the tunnel.</p><p>In my case I will just setup Mozilla to use the proxy. I love FoxyProxy so let’s setup the proxy there:</p><img src=images/foxyproxy.png alt="Image of FoxyProxy configuration"><p>My VPS is located in Paris and as you can see the traffic is being routed from there:</p><img src=images/ipgeolocation.png alt="Image of the page IpGeolocation showing that the traffic is being routed through DNS"><p>Also check this Wireshark capture, weird DNS queries everywhere!</p><img src=images/wireshark-pcap.png alt="Image of Wireshark capturing the DNS tunnel packets"><p>This is just <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a> encoding all our packages in DNS queries and sending them through the DNS protocol, as you can see is our VPS who is anwering to all of them.</p><h3 id=android>Android</h3><p>If you want to use all this in an Android device you would need to root it or use <a href=https://gitlab.com/andiodine/andiodine target=_blank rel="noopener noreffer">Andiodine</a>.</p><p>Basically with this app we are doing the same as we did in the previous section but without the SSH tunnel part. That means 2 things:</p><ol><li>The traffic is not encrypted but if you use secure protocols everything should be fine (As usual you know).</li><li>The routing is not performed by SSH and it is the Linux server the one doing the job.</li></ol><p>The second point is the problem, we need to make sure that the server is able to forward traffic and also that it is working as a NAT to avoid problems when the packages return. To get all this working I wrote this script that setup IP formarding and NAT before running <a href=https://github.com/yarrick/iodine target=_blank rel="noopener noreffer">Iodine</a> (Also it make sure to clean up everything when we close the server):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#! /bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Preparing system for ip forwarding...&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=m>1</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span class=line><span class=cl>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span>
</span></span><span class=line><span class=cl>iodined -c -f 10.2.0.1 -P PaSSW0RD dns.test.com
</span></span><span class=line><span class=cl><span class=nb>echo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Cleaning configuration...&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=m>0</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span class=line><span class=cl>iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
</span></span></code></pre></td></tr></table></div></div><p>One more thing, sometimes your VPS provider can disable IP forwarding at the network interface level, make sure to enable it there too following the documentation (Thanks Azure for losing my time figuring this out).</p><p>Once this is ready, we can setup a conection in the Android application and start using our DNS tunnel without problems in our non-rooted phone!</p><img src=images/andiodine.jpeg style=max-width:39% alt="Image of Andiodine app connected to the VPS">
<img src=images/ipgeolocation-mobile.jpeg style=max-width:60%;vertical-align:top alt="Image IpGeolocation showing that the Android device is routing the traffic through DNS"></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-11-13</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/dns-tunneling/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.anthares101.com/dns-tunneling/ data-title="DNS tunneling" data-via=@Anthares101 data-hashtags="bypass,red team,network,exfiltration"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.anthares101.com/dns-tunneling/ data-hashtag=bypass><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://blog.anthares101.com/dns-tunneling/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/bypass/>bypass</a>,&nbsp;<a href=/tags/red-team/>red team</a>,&nbsp;<a href=/tags/network/>network</a>,&nbsp;<a href=/tags/exfiltration/>exfiltration</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/attacking-wi-fi-networks-with-aircrack-ng/ class=prev rel=prev title="Attacking Wi-Fi networks with Aircrack-ng"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Attacking Wi-Fi networks with Aircrack-ng</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/posts/ target=_blank>Anthares101</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>